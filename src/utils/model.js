import { exec } from "child_process";
import path from "path";

function runmodel(csvfile) {
  const command = `python3 ${path.join(
    __dirname,
    "../../src/model/model.py"
  )} ${csvfile}`;
  return new Promise((resolve, reject) => {
    exec(command, (error, stdout, stderr) => {
      if (error) {
        console.error(`Error: ${error.message}`);
        reject(error.message);
        return;
      }
      console.log(stdout);
      if (stderr) {
        console.error(`stderr: ${stderr}`);
        reject(stderr);
        return;
      }
      const valid = stdout.replace(/'/g, '"');
      resolve(JSON.parse(valid));
    });
  });
}

export default runmodel;
