const { exec } = require('child_process')

async function runCommandAndCheckForKeyword(npcapPath) {
  return new Promise((resolve, reject) => {
    exec('cmd.exe /c echo %path%', (error, stdout, stderr) => {
      if (error) {
        reject(error)
        return
      }
      if (stderr) {
        console.error('Error:', stderr)
      }

      // Resolve with different values based on whether the keyword is found
      if (stdout.includes('Npcap')) {
        resolve()
      } else {
        // Run your command here
        exec(npcapPath, (error, stdout, stderr) => {
          if (error) {
            reject(error)
            return
          }
          if (stderr) {
            console.error('Error:', stderr)
          }
          console.log('Command executed successfully:', stdout)
          resolve()
        })
      }
    })
  })
}

export default runCommandAndCheckForKeyword
